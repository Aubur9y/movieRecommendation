<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>ä¸ªæ€§åŒ–ç”µå½±æ¨è</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #141414;
      color: #fff;
    }

    .container {
      max-width: 600px;
      margin: auto;
      padding: 60px 20px;
      text-align: center;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 20px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
      text-align: left;
    }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
    }

    input, select {
      background-color: #222;
      color: white;
    }

    button {
      margin-top: 30px;
      background-color: #e50914;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #b20710;
    }

    .movie-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .movie-card {
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 8px;
      text-align: left;
    }

    .movie-card h3 {
      margin: 0;
      font-size: 18px;
      color: #fff;
    }

    .movie-card p {
      margin-top: 8px;
      font-size: 14px;
      color: #bbb;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <!-- Step 1: ç”¨æˆ·ä¿¡æ¯å¡«å†™ -->
  <div id="step1" class="container">
    <h1>ç”¨æˆ·æ³¨å†Œ</h1>

    <label>æ€§åˆ«ï¼š</label>
    <select id="gender">
      <option value="M">ç”·</option>
      <option value="F">å¥³</option>
    </select>

    <label>å¹´é¾„ï¼š</label>
    <input type="number" id="age" placeholder="è¯·è¾“å…¥ä½ çš„å¹´é¾„">

    <label>èŒä¸šï¼š</label>
    <select id="occupation">
      <option value="0">å…¶ä»–</option>
      <option value="1">å­¦æœ¯äººå‘˜</option>
      <option value="2">è‰ºæœ¯å®¶</option>
      <option value="3">æ–‡å‘˜</option>
      <option value="4">å¤§å­¦ç”Ÿ</option>
      <option value="5">åŒ»ç”Ÿ</option>
      <option value="6">å¾‹å¸ˆ</option>
      <option value="7">ç¨‹åºå‘˜</option>
      <option value="8">é”€å”®</option>
      <option value="9">åˆ¶é€ ä¸š</option>
      <option value="10">ç®¡ç†</option>
      <option value="11">å®¶åŠ¡</option>
      <option value="12">é€€ä¼‘</option>
      <option value="13">è‡ªé›‡</option>
      <option value="14">æœåŠ¡ä¸š</option>
      <option value="15">ä¸­å°å­¦å­¦ç”Ÿ</option>
      <option value="16">æŠ€æœ¯å‘˜</option>
      <option value="17">ä½œå®¶</option>
      <option value="18">æ— ä¸š</option>
      <option value="19">å¨±ä¹ä¸š</option>
      <option value="20">ç§‘å­¦å®¶</option>
    </select>

    <button onclick="submitProfile()">å¼€å§‹æ¨è</button>
  </div>

  <!-- Step 2: æ¨èå±•ç¤º -->
  <div id="step2" class="container hidden">
    <h1>ä½ åº”è¯¥å–œæ¬¢ä»¥ä¸‹ç”µå½±</h1>
    <div class="movie-list" id="results"></div>
    <button onclick="goBack()" style="margin-top: 30px; background-color: #555;">
      ğŸ”™ è¿”å›ä¿®æ”¹ä¿¡æ¯
    </button>
  </div>

  <script>
    async function submitProfile() {
      const gender = document.getElementById("gender").value;
      const age = parseInt(document.getElementById("age").value);
      const occupation = parseInt(document.getElementById("occupation").value);

      if (!age || isNaN(age)) {
        alert("è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„ï¼");
        return;
      }

      const payload = { gender, age, occupation };

      try {
        const response = await fetch("http://localhost:8000/recommend", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await response.json();
        showResults(data);
      } catch (error) {
        alert("æ¨èè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æ¥å£æ˜¯å¦å¯åŠ¨ï¼");
        console.error(error);
      }
    }

    function showResults(data) {
      document.getElementById("step1").classList.add("hidden");
      document.getElementById("step2").classList.remove("hidden");

      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";

      if (data.length === 0) {
        resultsDiv.innerHTML = "<p>æš‚æ— æ¨èç»“æœã€‚</p>";
        return;
      }

      data.forEach(movie => {
        const card = document.createElement("div");
        card.className = "movie-card";
        card.innerHTML = `
          <h3>${movie.title}</h3>
          <p>ç±»å‹ï¼š${movie.genre}</p>
        `;
        resultsDiv.appendChild(card);
      });
    }

    function goBack() {
      document.getElementById("step2").classList.add("hidden");
      document.getElementById("step1").classList.remove("hidden");
    }
  </script>
</body>
</html>
